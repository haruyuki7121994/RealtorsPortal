@model src.Models.Package
@{
    Layout = "~/Views/Shared/_RealtorsPortalLayout.cshtml";
    ViewData["Title"] = "Payment Package Page";
}
}
<!-- Start Proerty header  -->
<section id="aa-property-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="aa-property-header-inner">
                    <h2>Packages</h2>
                    <ol class="breadcrumb">
                        <li><a href="#">HOME</a></li>
                        <li class="active">Customer</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Proerty header  -->
<div class="clearfix"></div>
<div style="margin-top: 20px">
    <div class="container">
        <div class="row">@Html.ActionLink("Back", "Index", "Customer", null, new { @class = "btn btn-danger" })</div>
        <div class="row">
            @{
                if (ViewBag.error != null)
                {
                    <div class="error-blog">
                        <h1>@ViewBag.error</h1>
                    </div>
                }
                if (TempData.Peek("Message") != null)
                {
                    <div class="error-blog">
                        <h3>Message: @TempData.Peek("Message")</h3>
                    </div>
                }
            }
            
        <div class="col-xs-12 col-md-4 col-md-offset-4">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form method="post" asp-action="Success" asp-controller="Customer">
                        <input asp-for="Id" type="hidden" />
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="form-group">
                                    <label><span class="hidden-xs">PACKAGE NAME</span></label>
                                    <input asp-for="Name" readonly class="form-control" id="packageName" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="form-group">
                                    <label>PRICE</label>
                                    <div class="input-group">
                                        <input readonly class="form-control" id="packagePrice" asp-for="Price" value="@Model.Price" />
                                        <span class="input-group-addon"><span class="fa fa-money"></span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6">
                                <div class="form-group">
                                    <label><span class="hidden-xs">LIMIT ADS</span></label>
                                    <input readonly class="form-control" value="@Model.Limit_ads" asp-for="Limit_ads" />
                                </div>
                            </div>
                            <div class="col-xs-6">
                                <div class="form-group">
                                    <label><span class="hidden-xs">LIMIT FEATURED ADS</span></label>
                                    <input readonly class="form-control" value="@Model.Limit_featured_ads" asp-for="Limit_featured_ads" />
                                </div>
                            </div>
                        </div>
                        <input type="submit" hidden="hidden" id="btnSubmit" />
                    </form>
                </div>
                <div class="panel-footer">
                    <div class="row">
                        <div class="col-xs-12" style="text-align: center"> <div id="paypal-button-container"></div> </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
    <br />
</div>
@section scripts {
    <script src="https://www.paypalobjects.com/api/checkout.js"></script>
    <script>

        // Render the PayPal button

        paypal.Button.render({

            // Set your environment

            env: 'sandbox', // sandbox | production

            // Specify the style of the button

            style: {
                label: 'paypal',
                size: 'medium',    // small | medium | large | responsive
                shape: 'rect',     // pill | rect
                color: 'blue',     // gold | blue | silver | black
                tagline: false
            },

            client: {
                sandbox: @ViewBag.paypalKey,
                production: '<insert production client id>'
            },

            payment: function (data, actions) {
                return actions.payment.create({
                    payment: {
                        transactions: [
                            {
                                amount: {
                                    total: parseFloat($("#packagePrice").val()).toString(),
                                    currency: 'USD'
                                }
                            }
                        ]
                    }
                });
            },

            onAuthorize: function (data, actions) {
                return actions.payment.execute().then(function () {
                    $("#btnSubmit").click();
                });
            }

        }, '#paypal-button-container');

    </script>
}
